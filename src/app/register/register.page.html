<ion-header>
  <ion-toolbar>
    <ion-title>Register</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="goToMenu()">
        <ion-icon name="menu-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="register-content">
  <div class="header-section">
    <h1>Register</h1>
    <p>skip the line, vote online</p>
  </div>

  <div class="main-content">
    <!-- Manual Staff Registration -->
    <div class="form-row">
      <div class="form-card">
        <div class="form-group">
          <label for="surname">Surname & Initials :</label>
          <input 
            type="text" 
            id="surname" 
            [(ngModel)]="staff.surname" 
            name="surname" 
            placeholder="Value"
            class="form-input">
        </div>
        <div class="form-group">
          <label for="phone">Phone No :</label>
          <input 
            type="tel" 
            id="phone" 
            [(ngModel)]="staff.phone" 
            name="phone" 
            placeholder="Value"
            class="form-input">
        </div>
      </div>

      <div class="form-card">
        <div class="form-group">
          <label for="course">Course :</label>
          <input 
            type="text" 
            id="course" 
            [(ngModel)]="staff.course" 
            name="course" 
            placeholder="Value"
            class="form-input">
        </div>
        <div class="form-group">
          <label for="year">Year :</label>
          <input 
            type="number" 
            id="year" 
            [(ngModel)]="staff.year" 
            name="year" 
            placeholder="Value"
            class="form-input">
        </div>
      </div>
    </div>

    <div class="form-card full-width">
      <div class="form-group">
        <label for="faculty">Faculty :</label>
        <input 
          type="text" 
          id="faculty" 
          [(ngModel)]="staff.faculty" 
          name="faculty" 
          placeholder="Value"
          class="form-input">
      </div>
      <button type="button" class="add-button" (click)="addStaff()">Add</button>
    </div>

    <!-- Spreadsheet Upload for Students -->
    <div class="form-card full-width upload-section">
      <h3>Upload Student Spreadsheet</h3>
      <p>Import multiple student registrations from Excel or CSV file</p>
      
      <input 
        type="file" 
        #fileInput 
        (change)="onFileSelected($event)"
        accept=".xlsx,.xls,.csv"
        style="display: none;">
      
      <button 
        type="button" 
        class="upload-button"
        (click)="fileInput.click()">
        <ion-icon name="cloud-upload-outline"></ion-icon>
        Choose Spreadsheet File
      </button>

      <div *ngIf="selectedFile" class="file-info">
        <span class="file-name">{{ selectedFile.name }}</span>
        <button type="button" class="remove-file" (click)="removeFile()">Ã—</button>
      </div>

      <button 
        *ngIf="selectedFile && !uploadedStudents.length"
        type="button"
        class="process-button"
        (click)="processFile()"
        [disabled]="processing">
        <ion-spinner *ngIf="processing" name="crescent"></ion-spinner>
        <span *ngIf="!processing">Process File</span>
        <span *ngIf="processing">Processing...</span>
      </button>
    </div>

    <!-- Student Data Grid -->
    <div *ngIf="uploadedStudents.length > 0" class="data-grid-container">
      <div class="data-grid-header">
        <h3>Student Data ({{ uploadedStudents.length }} students)</h3>
        <button class="save-all-button" (click)="saveAllStudents()">Save All Students</button>
      </div>
      
      <div class="data-grid">
        <div class="grid-header">
          <div class="grid-cell">Surname & Initials</div>
          <div class="grid-cell">Phone No</div>
          <div class="grid-cell">Course</div>
          <div class="grid-cell">Year</div>
          <div class="grid-cell">Faculty</div>
          <div class="grid-cell">Actions</div>
        </div>
        
        <div class="grid-row" *ngFor="let student of uploadedStudents; let i = index">
          <div class="grid-cell">{{ student.surname }}</div>
          <div class="grid-cell">{{ student.phone }}</div>
          <div class="grid-cell">{{ student.course }}</div>
          <div class="grid-cell">{{ student.year }}</div>
          <div class="grid-cell">{{ student.faculty }}</div>
          <div class="grid-cell actions">
            <button class="delete-btn" (click)="removeStudent(i)" title="Remove student">
              <ion-icon name="trash-outline"></ion-icon>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Floating navigation -->
    <div class="floating-nav">
      <ion-fab-button class="nav-fab" (click)="goToMenu()">
        <ion-icon name="menu-outline"></ion-icon>
      </ion-fab-button>
    </div>
  </div>
</ion-content>
